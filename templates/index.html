<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>IOT DHT11 + LED Control</title>
    <style>
        body { font-family: Arial; text-align: center; background: #f7f7f7; }
        h1 { color: #333; }
        .sensor-box {
            background: white;
            display: inline-block;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px #ccc;
            margin-top: 20px;
        }
        .btn {
            padding: 15px 30px;
            font-size: 20px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        .on { background: green; color: white; }
        .off { background: red; color: white; }
    </style>
</head>
<body>
    <h1>Xin ch√†o, {{ username }} (Quy·ªÅn h·∫°n: {{ quyenhan }})</h1>

    <h1>üå°Ô∏è Tr·∫°ng th√°i c·∫£m bi·∫øn DHT11</h1>
    <div class="sensor-box">
        <h2 id="temperature">Nhi·ªát ƒë·ªô: {{ temperature }} ¬∞C</h2>
        <h2 id="humidity">ƒê·ªô ·∫©m: {{ humidity }} %</h2>
    </div>

    <h1>üí° ƒêi·ªÅu khi·ªÉn LED</h1>
    <p>LED hi·ªán t·∫°i: <b id="led_status">{{ led_status }}</b></p>
    <a href="/led/ON"><button class="btn on">B·∫¨T LED</button></a>
    <a href="/led/OFF"><button class="btn off">T·∫ÆT LED</button></a>

    <p><a href="/signout">ƒêƒÉng xu·∫•t</a></p>

    <script>
        // H√†m c·∫≠p nh·∫≠t d·ªØ li·ªáu
        function updateData() {
            // D√πng fetch ƒë·ªÉ g·ªçi API l·∫•y d·ªØ li·ªáu m·ªõi t·ª´ server
            fetch('/get_updated_data')
                .then(response => response.json()) // Chuy·ªÉn ph·∫£n h·ªìi th√†nh JSON
                .then(data => {
                    // C·∫≠p nh·∫≠t n·ªôi dung tr√™n trang web
                    document.getElementById('temperature').innerText = `Nhi·ªát ƒë·ªô: ${data.temperature} ¬∞C`;
                    document.getElementById('humidity').innerText = `ƒê·ªô ·∫©m: ${data.humidity} %`;
                    document.getElementById('led_status').innerText = data.led_status;
                })
                .catch(error => console.error('Loi khi cap nhat du lieu:', error));
        }

        // G·ªçi h√†m updateData m·ªói 3 gi√¢y
        setInterval(updateData, 3000);
    </script>
</body>
</html>
